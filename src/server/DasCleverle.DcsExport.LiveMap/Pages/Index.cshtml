@page
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}

@section Scripts {
    <script src="~/js/map.js"></script>
    <script src="~/js/index.js"></script>
}

<div class="map-container">
    <div id="map" class="map" data-token="@Model.MapboxToken" data-style="@Model.MapboxStyle"></div>
    <div class="sidebar">
        <div id="sidebar-mission-properties"></div>
        <div id="sidebar-airbase-properties"></div>
    </div>
    <div id="loading" class="loading" style="display: none">
        <div class="backdrop"></div>
        <div class="loading-content">
            <div id="spinner" class="spinner-border" style="width: 5rem; height: 5rem"></div>
            <div id="error" class="alert alert-danger text-center mt-3" style="display: none;"></div>
        </div>
    </div>
</div>

<script type="text/template" data-template="connection-reconnecting">
    Die Verbindung zum Server ist abgebrochen. Versuche erneute Verbindung ...
</script>

<script type="text/template" data-template="connection-error">
    Die Verbindung konnte nicht hergestellt werden.
</script>

<script type="text/template" data-template="feature-popup">
    <div $for="feature of features" class="mt-2">
        <div class="mt-1">
            <strong>${feature.typeName}</strong><br/>
            ${feature.name}
        </div>
    </div>
</script>

<script type="text/template" data-template="mission-properties">
    <div class="card">
        <div class="card-header">
            Aktuelle Mission
        </div>

        <div class="card-body">
            <div class="row">
                <div class="col-12"><strong>Mission</strong></div>
                <div class="col-12">${missionName}</div>
            </div>

            <div class="row">
                <div class="col-12"><strong>Theatre</strong></div>
                <div class="col-12">${theatre}</div>
            </div>
        </div>
    </div>
</script>

<script type="text/template" data-template="airbase-properties">
    <div class="card">
        <div class="card-header">
            Ausgewähltes Airfield
        </div>

        <div class="card-body">
            <div class="row">
                <div class="col-12"><strong>Name</strong></div>
                <div class="col-12">${name}</div>
            </div>

            <div class="row">
                <div class="col-12"><strong>Tower</strong></div>
                <div class="col-12">${frequencies.map(f => (f / 1000000) + ' MHz').join(', ')}</div>
            </div>

            <div class="row">
                <div class="col-12"><strong>Runways</strong></div>
                <div class="col-12">${runways.map(r => r.name + ' (Kurs ' + r.course + ')').join(', ')}</div>
            </div>

            <div class="row" $if="beacons.tacan.length">
                <div class="col-12"><strong>TACAN</strong></div>
                <div class="col-12">${beacons.tacan.map(t => t.channel + t.mode).join(', ')}</div>
            </div>

            <div class="row" $if="beacons.ils.length">
                <div class="col-12"><strong>ILS</strong></div>
                <div class="col-12">${beacons.ils.map(t => t.runway + ': ' + (t.frequency / 1000000) + ' MHz').join(', ')}</div>
            </div>
        </div>
    </div>
</script>